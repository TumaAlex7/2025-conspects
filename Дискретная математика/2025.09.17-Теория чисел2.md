# Теория чисел 2

## Свойства НОД

### Утверждение о взаимно простых числах

**Утв.** $a,b,n \in \mathbb{Z}$
$$\begin{aligned} \gcd(a,n)=1 \\ \gcd(b,n) = 1 \end{aligned} \Rightarrow \gcd(ab,n) = 1$$

**Док-во:**  
$\gcd(a,n) = 1 \Rightarrow 1 = as + nt$  
$\gcd(b,n) = 1 \Rightarrow 1 = bx + ny$  
для некоторых $s,t,x,y \in \mathbb{Z}$  
$1 = 1 \cdot 1 = (as + nt) \cdot (bx + ny) = ab(st) + n(btx + asy + nty)$  
$$\begin{aligned} n \vdots \gcd(ab,n) \\ ab \vdots \gcd(ab,n) \end{aligned} \Rightarrow 1 \vdots \gcd(ab,n) \Rightarrow \gcd(ab,n) = 1$$

### Следствия

**Следствие 1.** $a_1, a_2, \ldots, a_k, n \in \mathbb{Z}$  
$\gcd(a_1, n) = 1, \gcd(a_2, n) = 1, \ldots, \gcd(a_k, n) = 1$ тогда $\gcd(a_1 \cdot a_2 \cdot \ldots \cdot a_k, n) = 1$

**Следствие 2.** $a_1, a_2, \ldots, a_k \in \mathbb{Z}$, $p$ - простое  
$\gcd(a_1, a_2, \ldots, a_k) \vdots p \Leftrightarrow \exists i : a_i \vdots p$

## Основная теорема арифметики

**Теорема.** Любое натуральное число раскладывается единственным образом на произведение простых чисел (с точностью до порядка)

**Док-во:**  
Пусть не так и пусть $n$ - наименьшее число, которое можно двумя способами  
$n = p_1 \cdot p_2 \cdot \ldots \cdot p_k = q_1 \cdot q_2 \cdot \ldots \cdot q_l$,  
где $p_i, q_j$ - простые числа, $p_i \neq q_j \forall i,j$  
$p_1 \neq q_1 p_2 \neq q_1 \ldots p_k \neq q_1 \Rightarrow \lnot(p_1 \vdots q_1) \lnot(p_2 \vdots q_1) \ldots \lnot(p_k \vdots q_1) \Rightarrow \lnot(p_1 \cdot p_2 \cdot \ldots \cdot p_k \vdots q_1) \Rightarrow \lnot(n \vdots q_1)$ - противоречие  

## НОК (Наименьшее общее кратное)

### Определение

**Опр.** *Наименьшее общее кратное* чисел $a, b \in \mathbb{Z}\setminus\{0\}$ - это $n \in \mathbb{N}$ такое что:
- $n \vdots a \land n \vdots b$
- $\forall m \in \mathbb{N} : m \vdots a \land m \vdots b \Rightarrow m \geq n$

**Обозначение:** $\text{lcm}(a,b) = \text{НОК}(a,b) = [a,b]$

### Формулы для НОД и НОК

**Утв.** $a,b \in \mathbb{N}$  
$a = p_1^{\alpha_1} \cdot p_2^{\alpha_2} \cdot \ldots \cdot p_k^{\alpha_k}$, где $p_i$ - различные простые  
$b = p_1^{\beta_1} \cdot p_2^{\beta_2} \cdot \ldots \cdot p_k^{\beta_k}$, $\alpha_i, \beta_i \in \mathbb{N} \cup \{0\}$  
тогда  
$\gcd(a,b) = p_1^{\min(\alpha_1, \beta_1)} \cdot p_2^{\min(\alpha_2, \beta_2)} \cdot \ldots \cdot p_k^{\min(\alpha_k, \beta_k)}$  
$\text{lcm}(a,b) = p_1^{\max(\alpha_1, \beta_1)} \cdot p_2^{\max(\alpha_2, \beta_2)} \cdot \ldots \cdot p_k^{\max(\alpha_k, \beta_k)}$

**Док-во:**  
Из [основной теоремы арифметики](#основная-теорема-арифметики)  
$\gcd(a,b) = p_1^{d_1} \cdot p_2^{d_2} \cdot \ldots \cdot p_k^{d_k}$  
$a \vdots \gcd(a,b) \Rightarrow \alpha_1 \geq d_1, \alpha_2 \geq d_2, \ldots$  
$b \vdots \gcd(a,b) \Rightarrow \beta_1 \geq d_1, \beta_2 \geq d_2, \ldots$  
$d_i \leq \min(\alpha_i, \beta_i)$  
$\Rightarrow \gcd(a,b) \leq p_1^{\min(\alpha_1, \beta_1)} \cdot p_2^{\min(\alpha_2, \beta_2)} \cdot \ldots \cdot p_k^{\min(\alpha_k, \beta_k)}$  
$\Rightarrow \gcd(a,b) = p_1^{\min(\alpha_1, \beta_1)} \cdot p_2^{\min(\alpha_2, \beta_2)} \cdot \ldots \cdot p_k^{\min(\alpha_k, \beta_k)}$

**Следствие:** $\gcd(a,b) \cdot \text{lcm}(a,b) = a \cdot b$

## Сравнения по модулю

### Определение и основные свойства

**Опр.** Целые числа $a,b$ называются *сравнимыми по модулю* $n$ тогда и только тогда, когда $(a-b) \vdots n$  
**Обозначается:** $a \equiv b \pmod{n}$

**Утверждение:** это отношение эквивалентности, т.е.:
- $a \equiv a \pmod{n}$ (рефлексивность)
- $a \equiv b \pmod{n} \Rightarrow b \equiv a \pmod{n}$ (симметричность)
- $a \equiv b \land b \equiv c \pmod{n} \Rightarrow a \equiv c \pmod{n}$ (транзитивность)

**Док-во транзитивности:**  
$$\begin{aligned} (a-b) \vdots n \\ (b-c) \vdots n \end{aligned} \Rightarrow (a-c) \vdots n$$

### Арифметические операции со сравнениями

**Теорема.** Если $a \equiv a' \pmod{n}$ и $b \equiv b' \pmod{n}$, тогда $a+b \equiv a'+b' \pmod{n}$ и $a \cdot b \equiv a' \cdot b' \pmod{n}$

**Док-во:**  
Сложение очевидно  
$ab - a'b' = ab - a'b + a'b - a'b' = (a-a')b + a'(b-b') \vdots n$

**Следствие.** $f(x_1, x_2, \ldots, x_n) \in \mathbb{Z}[x_1, x_2, \ldots, x_n]$  
$a_1 \equiv a_1', a_2 \equiv a_2', \ldots, a_n \equiv a_n' \pmod{n} \Rightarrow f(a_1, a_2, \ldots, a_n) \equiv f(a_1', a_2', \ldots, a_n') \pmod{n}$

### Быстрое возведение в степень по модулю

Хотим найти $a^k \pmod{n}$:
- если $k = 0$: $a^0 \equiv 1 \pmod{n}$
- если $k = 2t > 0$: $a^{2t} \equiv (a^t)^2 \pmod{n}$
- если $k = 2t + 1$: $a^{2t+1} \equiv a \cdot (a^t)^2 \pmod{n}$

Чтобы вычислить $a^k \pmod{n}$ нужно примерно $\log(k)$ операций

**Пример:** $13^{18} \pmod{19}$  
$13^{18} \equiv (13^9)^2 \equiv (-1)^2 \equiv 1$  
$13^9 \equiv (13^4)^2 \cdot 13 \equiv 4^2 \cdot 13 \equiv 16 \cdot 13 \equiv (-3) \cdot (-6) \equiv 18 \equiv -1$  
$13^4 \equiv (13^2)^2 \equiv (-2)^2 \equiv 4$  
$13^2 \equiv (-6)^2 \equiv 36 \equiv -2$

## Малая теорема Ферма

**Теорема.** Если $p$ - простое, то $a^p \equiv a \pmod{p}$

### Доказательство 1 (через ожерелья)

Если $a \equiv a' \pmod{p}$, то $a^p \equiv (a')^p \pmod{p}$  
Следовательно достаточно доказать для $a \in \mathbb{N}$

*[ожидается изображение]*

### Доказательство 2 (по индукции)

$a \in \mathbb{Z}_{\geq 0}$  
**База:** $a = 0 \qquad a^p \equiv a \pmod{p}$  
**Переход:** $a \rightarrow a+1$  
$(a+1)^p = a^p + C^{k}_{p} a^{p-1} + \ldots + C^{p-1}_{p} a + 1 \equiv a^p + 1 \equiv a+1 \pmod{p}$

## RSA (Rivest, Shamir, Adleman)

### Алгоритм

1) $p,q$ - простые, $n = p \cdot q$
2) $m = \text{lcm}(p-1, q-1)$  
3) $r$ такое, что $\gcd(r,m) = 1$  
4) $s$ такое, что $r \cdot s \equiv 1 \pmod{m}$

### Схема шифрования

| Я | Публично | Вы |
|---|----------|-----|
| $p,q,r$ | $n,r$ | $1 \leq x < n \qquad \gcd(x,n) = 1$ (99.9%) |
| $m$ | | $z \equiv x^r \pmod{n}$ |
| $z^s \pmod{n}$ | | |

### Доказательство корректности

**Утв.** $z^s \equiv x \pmod{n}$

**Док-во:**  
$z^s \equiv (x^r)^s \equiv x^{rs} \pmod{n}$  
$(rs-1) \vdots m \Rightarrow (rs-1) \vdots (p-1) \Rightarrow x^{rs-1} \equiv 1 \pmod{p}$  
$(rs-1) \vdots m \Rightarrow (rs-1) \vdots (q-1)$  
$(x^{rs-1} - 1) \vdots p,q \Rightarrow x^{rs-1} \vdots p \cdot q \Rightarrow$  
$x^{rs-1} \equiv 1 \pmod{n}$  
$x^{rs} \equiv x \pmod{n}$  
$z^s \equiv x \pmod{n}$

### Пример

| Я | Публично | Вы |
|---|----------|-----|
| $p = 7, q = 11$ | $n = 77$ | |
| $r = 13$ | $r = 13$ | |
| $m = \text{lcm}(6,10) = 30$ | | |
| $s = 7$ | | |
| | | $x = 4$ |
| $53^7 \equiv (-24)^7 \equiv (-2)^7 \cdot (12)^7 \equiv (-2)^7 \cdot (144)^3 \cdot 12 \equiv (-2)^7 \cdot (-10)^3 \cdot 12 = 128 \cdot 1000 \cdot 12 \equiv (-26) \cdot 230 \cdot 12 \equiv 26 \cdot 1 \cdot 12 \equiv 240 + 72 \equiv 9 + 72 \equiv 4 \pmod{77}$ | $z \equiv 4^{13} \equiv (4^6)^2 \cdot 4 \equiv (4^3)^4 \cdot 4 \equiv (-13)^4 \cdot 4 \equiv 169^2 \cdot 4 \equiv 15^2 \cdot 4 \equiv 225 \cdot 4 \equiv 900 \equiv 130 \equiv 53 \pmod{77}$ |